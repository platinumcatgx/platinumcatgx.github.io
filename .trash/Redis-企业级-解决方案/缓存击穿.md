# 缓存击穿
2021-06-28 10:23:08
            
---


缓存击穿就是单个高热数据过期的瞬间，数据访问量较大，未命中redis后，发起了大量对同一数据的数据库访问，导致对数 据库服务器造成压力。应对策略应该在业务数据分析与预防方面进行，配合运行监控测试与即时调整策略，毕竟单个key的过 期监控难度较高，配合雪崩处理策略即可。




场景：还是数据库服务器崩溃，但是才前的场景有点不太一样
1.  系统平稳运行过程中
2.  数据库连接量间激
3.  Redis服务器无大量key过期
4.  Redis内存平稳，无波动
5.  Redis服务器CPU正常
6.  数据库崩溃
问题排查：
1.  Redis中某个key过期，该key访问量巨大
2.  多个数据请求从服务器直接压到Redis后，均未命中
3.  Redis在短时间内发起了大量对数库中同一数据的访问
总而言之就两点：单个Key高热数据 , key过期




解决方案
1.  预先设定
> 以电商为例，每个商家根据店铺等级，指定若干款主打商品，在购物节期间，加大此类信息key的过期时
>
> 长注意：购物节不仅仅指当天，以及后续若干天，访问峰值呈现呈现逐渐降低的趋势
1.  现场调整
> 监控访问量，对自然流量濫增的数据延长过期时间或设置为永久性key
1.  后台新数据
> 启动定时任务，高峰期来临之前，刷新数据有效期，确保不丢失
1.  二级缓存
> 设置不同的失效时间，保障不会被同时淘汰就行
1.  加锁
> 分布式锁，防止被击穿，但是要汪意也是性能瓶颈，慎重！


总的来说、缓存击穿就是单个高热数据过期的期间，数据访问量较大，未命中redis后，发起了大量对同一数据的数据库访问，导致对数据库服务器造成压力。应对策略应该在业务数据分析与预防方面进行，配合运行监控
测试与即时调整策略，毕竟单个key的过期监控难度较高，配合雪崩处理策略即可。

![](../../../../static/files/缓存击穿-image1-14324882.png)))





